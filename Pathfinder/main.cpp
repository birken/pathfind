#include "windows.h"

#include "main.h"
#include "bfs.h"
#include <string>
#include <iostream>
#include <fstream>
#include <vector>

/*

--- START ---
Steps: 1634
304939 305922 306905 306904 307887 308870 308871 308872 308873 309856 310839 311822 312805 312806 313789 313790 314773 315756 316739 316738 317721 318704 319687 320670 320669 321652 322635 322634 323617 324600 325583 326566 327549 328532 329515 330498 330499 330500 330501 330502 331485 332468 333451 334434 335417 335416 335415 336398 337381 337382 337383 338366 339349 340332 341315 342298 343281 344264 345247 346230 346229 347212 348195 348194 349177 350160 351143 351142 352125 353108 353107 354090 355073 356056 356057 356058 356059 356060 356061 356062 357045 357046 357047 357048 356065 356066 356067 357050 358033 358034 359017 359018 359019 359020 359021 360004 360987 361970 362953 363936 363935 363934 363933 364916 365899 365898 365897 366880 367863 368846 369829 369828 370811 371794 372777 373760 373761 374744 375727 376710 377693 377694 378677 379660 379661 379662 380645 381628 381629 381630 381631 382614 383597 384580 385563 386546 387529 388512 388513 388514 388515 389498 389499 390482 391465 392448 393431 394414 395397 396380 397363 397364 397365 397366 397367 398350 399333 400316 400317 401300 401301 401302 401303 402286 403269 404252 404253 404254 405237 406220 406221 407204 408187 409170 410153 411136 411137 411138 411139 412122 413105 413104 414087 415070 416053 416054 416055 417038 418021 419004 419987 419986 419985 420968 421951 421952 421953 421954 422937 423920 424903 425886 426869 427852 427851 428834 429817 429816 429815 429814 430797 431780 432763 432764 433747 434730 434729 435712 436695 436694 437677 438660 439643 440626 441609 442592 442591 443574 444557 445540 446523 447506 447507 447508 447509 447510 446527 445544 444561 444562 444563 445546 445547 445548 446531 447514 448497 449480 449479 449478 450461 451444 452427 453410 454393 455376 456359 457342 457341 457340 457339 458322 459305 460288 461271 462254 463237 464220 464221 464222 464223 464224 465207 465208 465209 466192 466193 467176 468159 469142 470125 470126 470127 471110 472093 473076 474059 474060 475043 476026 476027 476028 477011 477994 478977 479960 480943 481926 482909 482910 482911 483894 484877 484878 484879 484880 485863 486846 486845 487828 487827 488810 489793 489792 490775 490774 491757 492740 493723 494706 495689 495690 496673 497656 497657 497658 497659 498642 499625 500608 501591 502574 502575 502576 502577 503560 504543 504542 504541 504540 505523 506506 506507 507490 508473 509456 510439 510438 511421 512404 513387 514370 514369 514368 515351 516334 517317 518300 519283 519282 520265 521248 522231 523214 523215 523216 523217 524200 525183 526166 527149 527150 528133 528134 528135 528136 529119 529120 530103 531086 531087 531088 531089 531090 532073 532074 532075 533058 533059 533060 533061 534044 535027 535028 536011 536012 536013 536014 536997 537980 537981 537982 537983 537984 538967 539950 539949 539948 539947 540930 541913 542896 543879 543880 544863 544864 544865 544866 544867 544868 543885 542902 542903 542904 542905 542906 542907 543890 543891 543892 544875 545858 545859 545860 546843 547826 547827 547828 548811 549794 549795 549796 549797 549798 550781 550782 550783 550784 550785 550786 550787 551770 552753 553736 553737 554720 555703 556686 557669 557670 558653 559636 560619 560618 561601 562584 563567 564550 565533 565534 565535 565536 566519 567502 568485 568484 569467 570450 570449 571432 572415 573398 573397 574380 575363 576346 577329 578312 579295 580278 580279 581262 581263 582246 583229 584212 585195 585196 585197 586180 586181 587164 588147 588146 589129 590112 591095 591094 592077 593060 594043 595026 595027 596010 596993 597976 597977 598960 599943 600926 601909 602892 602891 603874 604857 605840 606823 607806 607805 608788 609771 609772 609773 609774 609775 609776 609777 609778 608795 607812 607813 606830 605847 604864 603881 602898 602899 602900 602901 602902 602903 602904 603887 603888 603889 604872 604873 604874 604875 604876 604877 604878 605861 606844 607827 607828 608811 608812 608813 608814 608815 608816 608817 608818 608819 609802 610785 611768 612751 612752 613735 613736 613737 613738 614721 614722 614723 615706 615707 615708 615709 615710 616693 617676 617677 617678 617679 617680 617681 617682 617683 617684 618667 618668 619651 620634 620635 620636 621619 621620 621621 622604 622605 622606 622607 622608 622609 622610 623593 623594 623595 624578 625561 626544 627527 627528 628511 629494 629495 630478 631461 631462 632445 633428 634411 635394 635395 636378 636379 637362 638345 638344 639327 640310 640311 640312 640313 640314 640315 640316 640317 641300 642283 643266 643265 644248 645231 646214 646215 646216 646217 646218 646219 647202 647203 647204 648187 649170 649169 650152 651135 651136 652119 653102 654085 655068 656051 656052 656053 656054 656055 655072 655073 655074 656057 657040 658023 659006 659005 659988 660971 661954 662937 663920 664903 665886 665887 666870 667853 667852 668835 669818 670801 671784 672767 673750 673751 673752 673753 674736 675719 675718 676701 677684 677685 678668 679651 679652 680635 681618 682601 682602 683585 684568 685551 685552 686535 687518 688501 689484 690467 691450 691451 692434 693417 694400 695383 695384 695385 696368 697351 697352 697353 697354 697355 696372 696373 696374 697357 697358 697359 698342 698343 698344 698345 699328 699329 699330 699331 699332 699333 700316 701299 702282 703265 704248 704249 704250 705233 705234 706217 707200 708183 709166 710149 710150 711133 711134 711135 712118 713101 714084 714083 715066 715065 716048 717031 717032 718015 718998 718997 719980 720963 721946 722929 723912 724895 725878 725879 726862 727845 728828 728827 728826 728825 728824 729807 730790 731773 732756 732755 733738 734721 735704 736687 737670 738653 738654 738655 738656 738657 737674 736691 735708 735709 735710 735711 735712 735713 735714 735715 735716 735717 736700 737683 738666 739649 740632 741615 742598 743581 744564 745547 745548 745549 745550 745551 746534 746535 746536 746537 747520 747521 748504 748505 748506 749489 749490 749491 750474 751457 752440 752441 753424 754407 755390 756373 757356 757357 757358 758341 758342 758343 759326 759327 759328 758345 758346 758347 758348 758349 758350 759333 760316 761299 762282 763265 764248 765231 765232 765233 765234 766217 766218 766219 766220 766221 767204 768187 769170 770153 770154 771137 772120 772119 772118 773101 774084 775067 776050 776051 776052 776053 775070 775071 775072 776055 777038 778021 779004 779005 779006 779989 780972 780973 781956 782939 783922 783923 783924 783925 784908 784909 784910 784911 783928 783929 783930 783931 782948 782949 782950 781967 780984 780985 780986 780987 781970 781971 781972 780989 780990 780991 780992 780009 780010 780011 780012 780995 780996 780997 780998 780999 780016 780017 780018 780019 780020 780021 779038 778055 778056 778057 778058 778059 779042 779043 779044 778061 777078 776095 775112 774129 774130 774131 774132 774133 774134 774135 774136 774137 774138 774139 775122 775123 776106 777089 778072 778073 779056 779057 779058 780041 780042 780043 780044 780045 780046 781029 781030 781031 781032 780049 780050 780051 780052 781035 781036 781037 781038 781039 781040 781041 782024 782025 782026 781043 781044 781045 781046 781047 781048 782031 782032 783015 783998 784981 785964 785965 785966 785967 785968 785969 786952 786953 786954 786955 787938 787939 787940 786957 786958 786959 785976 785977 785978 785979 785980 785981 785982 785983 785984 785985 785986 785003 785004 785005 785006 785007 785990 786973 786974 786975 786976 786977 786978 786979 787962 788945 788946 789929 790912 791895 791896 792879 793862 794845 794846 794847 794848 794849 795832 795833 795834 794851 794852 794853 795836 796819 797802 798785 799768 800751 801734 802717 803700 804683 805666 806649 806650 806651 806652 806653 807636 808619 809602 809603 809604 808621 808622 808623 808624 807641 806658 806659 805676 804693 804694 804695 804696 804697 805680 805681 805682 805683 805684 804701 804702 804703 804704 805687 805688 805689 805690 805691 805692 806675 806676 806677 806678 806679 807662 808645 808646 808647 808648 808649 807666 806683 805700 805701 805702 804719 804720 804721 803738 802755 802756 802757 803740 804723 805706 805707 805708 806691 807674 808657 809640 809641 809642 810625 810626 810627 810628 810629 810630 810631 809648 808665 808664 807681 806698 806699 805716 805717 805718 804735 804736 804737 804738 804739 804740 804741 805724 805725 806708 807691 807692 807693 807694 807695 807696 808679 808680 808681 808682 809665 810648 811631 812614 813597 813598 813599 813600 813601 814584 815567 816550 817533 817534 817535 816552 816553 816554 816555 815572 814589 814590 814591 813608 813609 813610 813611 813612 813613 814596 814597 815580 816563 817546 818529 818530 818531 817548 816565 816566 816567 816568 816569 816570 817553 818536 818537 819520 819521 819522 819523 819524 819525 819526 818543 818544 818545 818546 818547 818548 818549 817566 816583 816584 815601 815602 815603 814620 814621 814622 814623 814624 814625 814626 815609 815610 815611 816594 816595 816596 816597 816598 816599 816600 816601 816602 817585 817586 817587 817588 817589 818572 818573 818574 818575 817592 817593 817594 817595 817596 817597 817598 817599 818582 818583 818584 817601 816618 815635 815636 815637 816620 816621 817604 818587 818588 819571 819572 819573 820556 820557 820558 820559 820560 820561 820562 820563 820564 820565 819582 819583 819584 820567 821550 821551 821552 822535 823518 824501 824502 824503 825486 826469 826470 826471 826472 826473 826474 826475 826476 826477 825494 824511 823528 822545 821562 821561 821560 822543 822542 822541 822540 822539 821556 820573 819590 818607 818608 818609 818610 818611 818612 818613 817630 817631 817632 817633 816650 816651 816652 815669 814686 814687 814688 814689 815672 815673 815674 814691 814692 814693 814694 814695 815678 815679 815680 815681 814698 813715 812732 811749 811750 811751 811752 811753 811754 811755 811756 811757 811758 811759 811760 811761 810778 810779 810780 810781 811764 811765 811766 811767 811768 811769 811770 812753 813736 813737 813738 813739 814722 815705 815706 816689 817672 817673 817674 817675 817676 817677 818660 819643 819644 819645 819646 819647 820630 821613 822596 823579 824562 825545 826528 827511 828494 829477 830460 831443 831444 832427 833410 833411 833412 833413 833414 834397 834398 834399 834400 834401 834402 834403 834404 835387 836370 837353 838336 839319 839320 839321 839322 839323 839324 840307 841290 842273 842274 842275 842276 843259 844242 845225 845226 845227 845228 845229 844246 844247 844248 844249 845232 845233 846216 846217 846218 845235 844252 844253 844254 844255 843272 843273 843274 844257 845240 845241 846224 846225 846226 846227 847210 848193 849176 850159 851142 852125 852126 852127 853110 854093 855076 855077 855078 855079 856062 857045 858028 859011 859010 859993 860976 860977 860978 861961 861962 862945 862946 862947 862948 862949 862950 862951 863934 864917 865900 865901 865902 866885 866886 866887 866888 867871 867872 868855 868856 868857 868858 868859 868860 868861 869844 869845 870828 870829 870830 870831 870832 870833 870834 870835 871818 871819 871820 872803 872804 872805 873788 874771 875754 876737 877720 877721 877722 878705 878706 879689 880672 880673 880674 880675 880676 880677 880678 880679 880680 880681 879698 879699 879700 879701 880684 881667 882650 882651 883634 884617 885600 886583 887566
--- END ---
*/
int main()
{
	char PrintBuffer[256];
	{
		OutputDebugString("\n--- START ---\n");
		unsigned char pMap[] = { 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1 };
		int pOutBuffer[12];
		int nSteps = FindPath(0, 0, 1, 2, pMap, 4, 3, pOutBuffer, 12);
		sprintf_s(PrintBuffer, "Steps: %d\n", nSteps);
		OutputDebugString( PrintBuffer );
		for (int i = 0; i < nSteps; ++i)
		{
			sprintf_s(PrintBuffer, "%d ", pOutBuffer[i]);
			OutputDebugString(PrintBuffer);
		}
		OutputDebugString("\n--- END ---\n");
	}

	{
		OutputDebugString("\n--- START ---\n");
		unsigned char pMap[] = { 0, 0, 1, 0, 1, 1, 1, 0, 1 };
		int pOutBuffer[7];
		int nSteps = FindPath(2, 0, 0, 2, pMap, 3, 3, pOutBuffer, 7);
		sprintf_s(PrintBuffer, "Steps: %d\n", nSteps);
		OutputDebugString(PrintBuffer);
		for (int i = 0; i < nSteps; ++i)
		{
			sprintf_s(PrintBuffer, "%d ", pOutBuffer[i]);
			OutputDebugString(PrintBuffer);
		}
		OutputDebugString("\n--- END ---\n");
	}

	{
		OutputDebugString("\n--- START ---\n");

		using namespace std;

		streampos size;
	
		ifstream file("maze.txt");
		if (file.is_open())
		{
			size = file.tellg();
			std::vector<unsigned char> Map;
			Map.reserve(1024 * 1024);
			while (!file.eof())
			{
				int nGet = file.get();
				if (nGet == '#')
				{
					Map.push_back(0);
				}
				else if (nGet == '.')
				{
					Map.push_back(1);
				}
				else
				{
					// do nothing
				}
			}
			file.close();
			int nMapSize = Map.size();
			if (nMapSize == 983 * 991)
			{
				int* pOutBuffer = new int[10000];
				int nSteps;
				for (int i = 0; i < 50; ++i)
				{
					nSteps = FindPath(900, 902, 210, 310, &Map[0], 983, 991, pOutBuffer, 10000);
					nSteps = FindPath(210, 310, 900, 902, &Map[0], 983, 991, pOutBuffer, 10000);
				}
				sprintf_s(PrintBuffer, "Steps: %d\n", nSteps);
				OutputDebugString(PrintBuffer);
				for (int i = 0; i < nSteps; ++i)
				{
					sprintf_s(PrintBuffer, "%d ", pOutBuffer[i]);
					OutputDebugString(PrintBuffer);
				}
				OutputDebugString("\n--- END ---\n");
				delete[] pOutBuffer;
			}
		}

	}

	const char* pMap = "0000100001"
		"0000100001"
		"0000100001"
		"0000100001"
		"0000100001";

	std::string Out;
	const int nWidth = 10;
	const char* pCurrent = pMap;
	int nLine = nWidth;
	while (*pCurrent)
	{
		if (nLine == 0)
		{
			Out += '\n';
			nLine = nWidth;
		}
		Out += *pCurrent;
		--nLine;
		++pCurrent;
	}
	OutputDebugString("\n--- START ---\n");
	OutputDebugString( Out.c_str() );
	OutputDebugString( "\n--- END ---\n");
	return 0;
}
